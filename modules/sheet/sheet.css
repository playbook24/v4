/**
 * modules/sheet/sheet.css
 * Ajout des Lignes d'Alignement
 */
.view-screen { display: none; width: 100%; height: calc(100vh - 73px); overflow-y: auto; background: var(--color-background); }
.view-screen.active { display: block; }
.view-screen.studio-layout { display: flex; overflow: hidden; }

.selection-container { max-width: 1000px; margin: 40px auto; padding: 20px; }
.btn-back-hub { background: transparent; border: 1px solid var(--color-border); color: var(--color-text); padding: 8px 15px; border-radius: 6px; cursor: pointer; margin-bottom: 20px; transition: 0.2s; font-weight: bold;}
.btn-back-hub:hover { border-color: var(--color-primary); color: var(--color-primary); }

.search-input { width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; border: 1px solid var(--color-border); background: var(--color-container); color: white; }
.tags-filter-bar { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
.tag-chip { padding: 6px 12px; background: var(--color-container); border: 1px solid var(--color-border); border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.2s;}
.tag-chip.active { background: var(--color-primary); color: #000; border-color: var(--color-primary); font-weight: bold; }

.grid-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; }
.grid-card { background: var(--color-container); border: 1px solid var(--color-border); border-radius: 8px; padding: 15px; cursor: pointer; transition: all 0.2s; text-align: center; color: var(--color-text); display:flex; flex-direction:column; }
.grid-card:hover { transform: translateY(-3px); border-color: var(--color-primary); box-shadow: var(--shadow-lifted); }
.grid-card img { width: 100%; height: 110px; object-fit: contain; background: #BFA98D; border-radius: 4px; margin-bottom: 10px; border: 1px solid var(--color-border); }

.storage-list { display: flex; flex-direction: column; gap: 10px; }
.storage-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--color-container); border: 1px solid var(--color-border); border-radius: 8px; cursor: pointer; color: var(--color-text); }
.storage-item:hover { border-color: var(--color-primary); }

.studio-sidebar { width: 360px; background: var(--color-container); border-right: 1px solid var(--color-border); display: flex; flex-direction: column; z-index: 10; }
.sidebar-section { padding: 20px; border-bottom: 1px solid var(--color-border); }
.sidebar-tools-section { background: rgba(191, 169, 141, 0.05); }

.studio-tool-btn {
    width: 100%; background: var(--color-background); border: 1px solid var(--color-border);
    color: var(--color-text); padding: 8px 12px; border-radius: 6px; cursor: pointer;
    font-size: 0.9em; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s;
}
.studio-tool-btn.mini { padding: 6px; font-size: 1.1em; font-weight: bold; }
.studio-tool-btn:hover { border-color: var(--color-primary); color: var(--color-primary); }

.playbook-gallery-list { display: flex; flex-direction: column; gap: 15px; overflow-y: auto; padding-right: 5px; padding-bottom: 20px; }
.scene-list-item { display: flex; gap: 10px; background: var(--color-background); border: 1px solid var(--color-border); border-radius: 8px; padding: 10px; transition: border-color 0.2s; }
.scene-list-item:hover { border-color: var(--color-primary); }

.scene-col-img { flex: 1.5; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: 0.2s; }
.scene-col-img img { width: 100%; height: 90px; object-fit: contain; background: #BFA98D; border-radius: 4px; border: 1px solid var(--color-border); margin-bottom: 5px; }
.scene-col-img span { font-size: 0.85em; font-weight: bold; color: var(--color-text); }
.scene-col-img:hover { transform: scale(1.02); color: var(--color-primary); }

.scene-col-note { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; background: rgba(191,169,141,0.05); border: 1px dashed var(--color-border); border-radius: 6px; padding: 10px; transition: 0.2s; }
.scene-col-note:hover { border-color: var(--color-primary); background: rgba(191,169,141,0.15); color: var(--color-primary); }
.scene-col-note svg { width: 24px; height: 24px; fill: currentColor; margin-bottom: 5px; }
.scene-col-note span { font-size: 0.85em; font-weight: bold; }
.scene-col-note.disabled { opacity: 0.4; cursor: not-allowed; pointer-events: none; border-color: var(--color-border); background: transparent; }

.exo-btn-list { justify-content: flex-start; text-align: left; margin-bottom: 8px; }

.studio-workspace { flex: 1; overflow: auto; display: flex; flex-direction: column; align-items: center; padding: 40px; background: #0a0a0a; }
#pages-container { display: flex; flex-direction: column; gap: 40px; align-items: center; width: 100%; }

.a4-page {
    width: 794px; height: 1123px; background: #ffffff;
    border: 2px solid var(--color-primary); border-radius: 4px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.8); position: relative; overflow: hidden; flex-shrink: 0;
}

.page-delete-btn {
    position: absolute; top: 15px; right: 15px; background: var(--color-container); color: var(--color-text);
    border: 1px solid var(--color-border); border-radius: 8px; padding: 8px; cursor: pointer; z-index: 50; display:flex; align-items:center; justify-content:center;
}
.page-delete-btn svg { width: 20px; height: 20px; fill: currentColor; }
.page-delete-btn:hover { background: #ff4a4a; border-color: #ff4a4a; color: #fff; }

.draggable-element { position: absolute; border: 1px solid transparent; }
.draggable-element.selected { z-index: 100; }

.text-wrapper { overflow: visible !important; }
.drag-text {
    width: 100%; height: 100%; padding: 15px;
    color: #000000; font-family: 'Montserrat', sans-serif; font-size: 16px; outline: none; white-space: pre-wrap; line-height: 1.4;
    border: 2px solid var(--color-primary); border-radius: 12px; background: rgba(255, 255, 255, 0.95); transition: all 0.2s;
}
.drag-text.no-border { border-color: transparent !important; background: transparent !important; padding: 0 !important; }

.move-handle {
    position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
    background: var(--color-primary); color: #000; padding: 2px 15px; border-radius: 4px 4px 0 0;
    cursor: grab; font-weight: bold; display: none; z-index: 10; user-select: none; font-size: 14px;
}
.draggable-element.selected .move-handle { display: block; }
.move-handle:active { cursor: grabbing; }

.crop-box { width: 100%; height: 100%; overflow: hidden; position: relative; border-radius: 4px; border: 2px solid #000000; box-sizing: border-box; }
.draggable-element.selected .crop-box { border-color: var(--color-primary); border-style: dashed; }
.drag-image { position: absolute; display: block; max-width: none; pointer-events: none; object-fit: cover; object-position: top left; }

.resize-handle, .crop-handle { position: absolute; display: none; z-index: 10; }
.draggable-element.selected .resize-handle, .draggable-element.selected .crop-handle { display: block; }

.resize-handle { width: 16px; height: 16px; bottom: -8px; right: -8px; border-radius: 50%; background: var(--color-primary); border: 2px solid #fff; cursor: nwse-resize; }
.crop-handle.top { width: 24px; height: 8px; top: -4px; left: calc(50% - 12px); background: #444; border: 1px solid #fff; border-radius: 4px; cursor: ns-resize; }
.crop-handle.bottom { width: 24px; height: 8px; bottom: -4px; left: calc(50% - 12px); background: #444; border: 1px solid #fff; border-radius: 4px; cursor: ns-resize; }
.crop-handle.left { width: 8px; height: 24px; left: -4px; top: calc(50% - 12px); background: #444; border: 1px solid #fff; border-radius: 4px; cursor: ew-resize; }
.crop-handle.right { width: 8px; height: 24px; right: -4px; top: calc(50% - 12px); background: #444; border: 1px solid #fff; border-radius: 4px; cursor: ew-resize; }

/* === NOUVEAU : LIGNES D'ALIGNEMENT FAÇON CANVA === */
.align-guide { position: absolute; background-color: #00e5ff; z-index: 999; pointer-events: none; }
.guide-v { width: 1px; top: 0; bottom: 0; border-left: 1px dashed #00e5ff; background: transparent; }
.guide-h { height: 1px; left: 0; right: 0; border-top: 1px dashed #00e5ff; background: transparent; }
/* RESPONSIVE STUDIO PDF */
@media (max-width: 1024px) {
    .view-screen.studio-layout {
        flex-direction: column;
        overflow-y: auto;
    }
    .studio-sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid var(--color-border);
        max-height: 300px;
    }
    .studio-workspace {
        padding: 10px;
    }
    .a4-page {
        /* Permet à la page A4 de s'adapter sur petit écran tout en gardant son ratio */
        width: 100%;
        max-width: 794px;
        height: auto;
        aspect-ratio: 794 / 1123;
    }
}